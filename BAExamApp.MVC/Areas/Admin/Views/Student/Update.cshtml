@model AdminStudentUpdateVM

@{
    ViewData["Title"] = @SharedLocalizer["Update"];
}

<div class="content container my-5 d-flex flex-column flex-column-fluid card w-50 m-auto" id="kt_content" style="border-radius: 30px; background: #e0e0e0; box-shadow: 15px 15px 30px #bebebe, -15px -15px 30px #ffffff;">
    <div class="card-body h-lg-100 w-100" id="kt_contacts_main">
        <div class="card-header pt-7" id="kt_chat_contacts_header">
            <div class="card-title">
                <h2 class="text-center" style="font-size:25px;font-weight:bold">@SharedLocalizer["Update"]</h2>
            </div>
        </div>
        <div class="card-body pt-5">
            <form class="form fv-plugins-bootstrap5 fv-plugins-framework" asp-action="Update" asp-controller="Student" asp-area="Admin" enctype="multipart/form-data">
                <input type="hidden" asp-for="Id" />
                <div class="mt-1">
                    <div class="image-input image-input-outline" data-kt-image-input="true" style="position: relative;">
                        <div style="display: flex; justify-content: flex-start;">
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" title="@SharedLocalizer["Upload_Profile_Picture"]" id="addPreview" style="position: absolute; top: 5px; left: 5px;">
                                <i class="bi bi-pencil-fill fs-7"></i>
                            </a>
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" id="removePreview" title="@SharedLocalizer["Cancel_Profile_Picture"]" style="position: absolute; top: 5px; left: 95px;">
                                <i class="bi bi-x fs-2"></i>
                            </a>
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" id="removePicture" title="@SharedLocalizer["Remove_Profile_Picture"]" style="position: absolute; top: 95px; left: 5px;" onclick="removeImage()">
                                <i class="bi bi-trash fs-5"></i>
                            </a>
                            <img id="previewImage" class="w-125px h-125px" style="display: none;" alt="Preview" />
                            @if (Model.Image != null)
                            {
                                <img id="defaultImage" class="w-125px h-125px" src="data:image/jpeg;base64,@Model.Image" alt="Profile" />
                            }
                            else
                            {
                                <img id="defaultImage" class="w-125px h-125px" src="~/images/blank-profile-picture.png" alt="Profile" />
                            }
                            <input type="file" asp-for="NewImage" id="fileInput" accept=".jpg,.jpeg,.png" style="visibility: hidden;" />
                        </div>
                        <span asp-validation-for="NewImage.Length" class="text-danger"></span>
                        <span asp-validation-for="NewImage.ContentType" class="text-danger"></span>
                    </div>
                </div>
                <div class="fv-row mb-7 fv-plugins-icon-container">
                    <div class="d-flex align-items-center">
                        <label asp-for="FirstName" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                        </label>
                        <span class="required"></span>
                        <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                           data-bs-original-title="Öğrencinin adını giriniz."
                           aria-label="Öğrencinin adını giriniz."></i>
                    </div>
                    <input type="text" class="form-control form-control-solid" asp-for="FirstName">
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                    <div class="fv-plugins-message-container invalid-feedback"></div>
                </div>
                <div class="fv-row mb-7">
                    <div class="d-flex align-items-center">
                        <label asp-for="LastName" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                        </label>
                        <span class="required"></span>
                        <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                           data-bs-original-title="Öğrencinin soyadını giriniz."
                           aria-label="Öğrencinin soyadını giriniz."></i>
                    </div>
                    <input type="text" class="form-control form-control-solid" asp-for="LastName">
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>
                <div class="fv-row mb-7">
                    <label asp-for="Gender" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                    </label>
                    <select class="form-select form-select-solid lh-1 py-3 form-control-solid" asp-for="Gender">
                        <option value="@false">@SharedLocalizer["Woman"]</option>
                        <option value="@true">@SharedLocalizer["Man"]</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </div>
                <div class="fv-row mb-7">
                    <div class="d-flex align-items-center">
                        <label asp-for="Email" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                        </label>
                        <span class="required"></span>
                        <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                           data-bs-original-title="Öğrencinin mail adresini giriniz."
                           aria-label="Öğrencinin mail adresini değiştirmek isterseniz yazınız."></i>
                    </div>
                    <div class="d-flex">
                        <input type="text" class="form-control form-control-solid" asp-for="Email">
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>
                @if (Model.OtherEmails != null)
                {
                    @foreach (var items in Model.OtherEmails)
                    {
                        <div class="fv-row mb-7">
                            <div class="d-flex align-items-center">
                                <label asp-for="OtherEmails" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                                </label>
                                <span class="required"></span>
                                <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                                   data-bs-original-title="Öğrencinin diğer mail adresini giriniz."
                                   aria-label="Öğrencinin diğer mail adresini giriniz."></i>
                            </div>
                            <div class="d-flex">
                                <input type="text" class="form-control form-control-solid" value="@items" name="otherEmails">
                                <span asp-validation-for="OtherEmails" class="text-danger"></span>
                                <div class="align-self-end d-flex flex-row-reverse justify-content-end ms-2">
                                    <a class="btn btn-danger btn-sm" onclick="removeMail(this)"><span class="h5 text-light">X</span></a>
                                </div>
                            </div>
                        </div>
                    }
                    <div id="otherEmails"></div>
                    <div class="d-grid d-md-flex justify-content-md-end">
                        <div class="btn">
                            <button class="w3-green w3-button w3-round fw-bold" type="button" onclick="addOtherEmail()">@ViewLocalizer["Add_Other_Email"]</button>
                            <div class="fv-plugins-message-container invalid-feedback"></div>
                        </div>
                    </div>
                }
                <div class="fv-row mb-7 fv-plugins-icon-container">
                    <div class="d-flex align-items-center">
                        <label asp-for="DateOfBirth" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                        </label>
                        <span class="required"></span>
                        <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                           data-bs-original-title="Öğrencinin doğum tarihini giriniz."
                           aria-label="Öğrencinin doğum tarihini giriniz."></i>
                    </div>
                    <input type="date" class="form-control form-control-solid" asp-for="DateOfBirth">
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                    <div class="fv-plugins-message-container invalid-feedback"></div>
                </div>
                <div class="fv-row mb-7">
                    <div class="d-flex align-items-center">
                        <label asp-for="CityId" class="form-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                        <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                           data-bs-original-title="@SharedLocalizer["Select_City"]"
                           aria-label="@SharedLocalizer["Select_City"]"></i>
                    </div>
                    <select asp-for="CityId" asp-items="Model.Cities" class="form-select form-select-solid lh-1 py-3 form-control-solid"></select>
                    <span asp-validation-for="CityId" class="text-danger"></span>
                </div>
                <input type="text" asp-for="Image" id="pictureText" style="visibility: hidden;" />
                <div class="separator mb-6"></div>
                <div class="d-flex justify-content-end">
                    <a type="submit" data-kt-contacts-type="submit"
                       class="w3-blue w3-button w3-round fw-bold mx-2" asp-controller="Student" asp-action="Index">
                        @SharedLocalizer["Back_List"]
                    </a>
                    <button type="submit" data-kt-contacts-type="submit" class="w3-green w3-button w3-round fw-bold mx-2">
                        <span class="indicator-label">@SharedLocalizer["Save"]</span>
                        <span class="indicator-progress">
                            Please wait...
                            <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                        </span>
                    </button>
                </div>
                <div></div>
            </form>
        </div>
    </div>
</div>
<script>
    var validationMessage = "@SharedLocalizer["Picture_Format_Error"]";
</script>

<script>
    function addOtherEmail() {

        //Create examRuleSubject html
        let template = `<div class="fv-row mb-7 fv-plugins-icon-container w-85">
                                            <div class="d-flex align-items-center">
                                                <label class="form-label mt-3" style="font-size: 20px; font-weight: bold;">Mail Adresi
                                                </label>
                                                <span class="required"></span>
                                                <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip"
                                                   title="" data-bs-original-title="Öğrencinin emailini giriniz."
                                                   aria-label="Öğrencinin emailini giriniz."></i>
                                            </div>
                                            <div class="d-flex">
                                                    <div class="fv-plugins-message-container invalid-feedback d-flex me-2">
                                            <input type="email" class="form-control form-control-solid bg-white border" name="otherEmails" required>
                                            <span class="text-danger"></span>
                                                </div>
                                                <div class="align-self-end d-flex flex-row-reverse justify-content-end">
                                                    <a class="btn btn-danger btn-sm" onclick="removeMail(this)"><span class="h5 text-light">X</span></a>
                                              </div>
                                                  </div>
                                        </div>`;

        //Append created otheremails
        $("#otherEmails").append(template);

    }
</script>

<script>
    function removeMail(prop) {
        //Removing examruleSubject
        $(prop).parent().parent().parent().remove();
    }
</script>