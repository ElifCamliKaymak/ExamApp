@model AdminTrainerUpdateVM

@{
    ViewData["Title"] = SharedLocalizer["Update"];
}

<div class="content container my-5 d-flex flex-column flex-column-fluid card w-50 m-auto" id="kt_content" style="border-radius: 30px; background: #e0e0e0; box-shadow: 15px 15px 30px #bebebe, -15px -15px 30px #ffffff;">
    <div class="card-body h-lg-100 w-100" id="kt_contacts_main">
        <div class="card-header pt-7" id="kt_chat_contacts_header">
            <div class="card-title">
                <h2 class="text-center" style="font-size:25px;font-weight:bold">@SharedLocalizer["Update"]</h2>
            </div>
        </div>
        <div class="card-body pt-5">
            <form class="form fv-plugins-bootstrap5 fv-plugins-framework" asp-action="Update" asp-controller="Trainer" asp-area="Admin" enctype="multipart/form-data">
                <input type="hidden" asp-for="Id" />
                <div class="mt-1">
                    <div class="image-input image-input-outline" data-kt-image-input="true" style="position: relative;">
                        <div style="display: flex; justify-content: flex-start;">
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" title="@SharedLocalizer["Upload_Profile_Picture"]" id="addPreview" style="position: absolute; top: 5px; left: 5px;">
                                <i class="bi bi-pencil-fill fs-7"></i>
                            </a>
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" id="removePreview" title="@SharedLocalizer["Cancel_Profile_Picture"]" style="position: absolute; top: 5px; left: 95px;">
                                <i class="bi bi-x fs-2"></i>
                            </a>
                            <a class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow" id="removePicture" title="@SharedLocalizer["Remove_Profile_Picture"]" style="position: absolute; top: 95px; left: 5px;" onclick="removeImage()">
                                <i class="bi bi-trash fs-5"></i>
                            </a>
                            <img id="previewImage" class="w-125px h-125px" style="display: none;" alt="Preview" />
                            @if (Model.Image != null)
                            {
                                <img id="defaultImage" class="w-125px h-125px" src="data:image/jpeg;base64,@Model.Image" alt="Profile" />
                            }
                            else
                            {
                                <img id="defaultImage" class="w-125px h-125px" src="~/images/blank-profile-picture.png" alt="Profile" />
                            }
                            <input type="file" asp-for="NewImage" id="fileInput" accept=".jpg,.jpeg,.png" style="visibility: hidden;" />
                        </div>
                        <span asp-validation-for="NewImage.Length" class="text-danger"></span>
                        <span asp-validation-for="NewImage.ContentType" class="text-danger"></span>
                    </div>
                </div>
                <div class="form-group">
                    <label asp-for="FirstName" class="control-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <input asp-for="FirstName" class="form-control mt-2" />
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="LastName" class="control-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <input asp-for="LastName" class="form-control mt-2 " />
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label asp-for="Gender" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                    </label>
                    <select class="form-select form-select-solid lh-1 py-3 form-control-solid" asp-for="Gender">
                        <option value="@false">@SharedLocalizer["Woman"]</option>
                        <option value="@true">@SharedLocalizer["Man"]</option>
                    </select>
                    <span asp-validation-for="Gender" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <div class="d-flex align-items-center">
                        <label asp-for="Email" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                        </label>
                        <span class="required"></span>
                    </div>
                    <div class="d-flex">
                        <input type="text" class="form-control form-control-solid" asp-for="Email">
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>
                </div>
                @if (Model.OtherEmails != null)
                {
                    @foreach (var items in Model.OtherEmails)
                    {
                        <div class="fv-row mb-7">
                            <div class="d-flex align-items-center">
                                <label asp-for="OtherEmails" class="form-label mt-3" style="font-size: 20px; font-weight: bold;">
                                </label>
                                <span class="required"></span>
                                <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip" title=""
                                   data-bs-original-title="Eğitmenin diğer mail adresini giriniz."
                                   aria-label="Eğitmenin diğer mail adresini giriniz."></i>
                            </div>
                            <div class="d-flex">
                                <input type="text" class="form-control form-control-solid" value="@items" name="otherEmails">
                                <span asp-validation-for="OtherEmails" class="text-danger"></span>
                                <div class="align-self-end d-flex flex-row-reverse justify-content-end ms-2">
                                    <a class="btn btn-danger btn-sm" onclick="removeMail(this)"><span class="h5 text-light">X</span></a>
                                </div>
                            </div>
                        </div>

                    }
                    <div id="otherEmails"></div>
                    <div class="d-grid d-md-flex justify-content-md-end">
                        <div class="btn">
                            <button class="w3-green w3-button w3-round fw-bold" type="button" onclick="addOtherEmail()">@ViewLocalizer["Add_Other_Email"]</button>
                            <div class="fv-plugins-message-container invalid-feedback"></div>
                        </div>
                    </div>
                }

                <div class="form-group">
                    <label asp-for="DateOfBirth" class="control-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <input type="date" asp-for="DateOfBirth" class="form-control mt-2" />
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="CityId" class="control-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <select asp-for="CityId" asp-items="Model.CityList" class="form-select"></select>
                    <span asp-validation-for="CityId" class="text-danger"></span>
                </div>

                <div class="form-group mt-2">
                    <label asp-for="TrainerTalentIds" class="control-label  mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <select class="form-control pillbox-select2" asp-items="Model.TalentList" asp-for="TrainerTalentIds" multiple="multiple"></select>
                    <span asp-validation-for="TrainerTalentIds" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="TechnicalUnitId" class="control-label mt-3" style="font-size: 20px; font-weight: bold;"></label>
                    <select asp-for="TechnicalUnitId" onchange="getProducts()" asp-items="Model.TechnicalUnitList" class="form-select">
                        <option value="@Guid.Empty">Teknik Birim Seçiniz</option>
                    </select>
                    <span asp-validation-for="TechnicalUnitId" class="text-danger"></span>
                </div>
                <input type="text" asp-for="Image" id="pictureText" style="visibility: hidden;" />
                <div class="separator mb-6"></div>
                <div class="d-flex justify-content-end">
                    <a type="submit" data-kt-contacts-type="submit"
                       class="w3-blue w3-button w3-round fw-bold mx-2" asp-controller="Trainer" asp-action="Index">
                        @SharedLocalizer["Back_List"]
                    </a>
                    <button type="submit" data-kt-contacts-type="submit" class="w3-green w3-button w3-round fw-bold mx-2">
                        <span class="indicator-label">@SharedLocalizer["Save"]</span>
                        <span class="indicator-progress">
                            Please wait...
                            <span class="spinner-border spinner-border-sm align-middle ms-2"></span>
                        </span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>


@section Scripts {
    <script>
        var validationMessage = "@SharedLocalizer["Picture_Format_Error"]";
    </script>
    <script src="~/js/trainerUpdate.js"></script>

    @*pllbox select2 çalışmasını sağlar*@
    <script src="~/js/jquery.min.js"></script>
    <script src="~/js/select2.js"></script>
    <script>
        $(document).ready(function () {
            $('.pillbox-select2').select2({
                placeholder: "--- Seçiniz ---",
                allowClear: true,
                closeOnSelect: false,
                templateResult: function (state) {
                    if (!state.id) { return state.text; }
                    return $("<div><input type='checkbox' id='checkbox-" + state.id + "' class='form-check-input' " + (state.selected ? "checked" : "") + "> <label for='checkbox-" + state.id + "'>" + state.text + "</label></div>")
                        .click(function (e) {
                            if ($(e.target).is("input")) {
                                $('.pillbox-select2').trigger('change');
                            }
                        });
                },
                templateSelection: function (state) {
                    if (!state.id) { return state.text; }
                    return $("<div style='padding-left: 22px'>" + state.text + "</div>");

                },
            });
        });
    </script>
    
}

<script>
    function addOtherEmail() {

        //Create examRuleSubject html
        let template = `<div class="fv-row mb-7 fv-plugins-icon-container w-85">
                     <div class="d-flex align-items-center">
                     <label class="form-label mt-3" style="font-size: 20px; font-weight: bold;">Diğer Mail Adresi
                     </label>
                     <span class="required"></span>
                      <i class="fas fa-exclamation-circle ms-1 fs-7" data-bs-toggle="tooltip"
                      title="" data-bs-original-title="Eğitmenin emailini giriniz."
                       aria-label="Eğitmenin emailini giriniz."></i>
                      </div>
                     <div class="d-flex">
                      <div class="fv-plugins-message-container invalid-feedback d-flex me-2">
                         <input type="email" class="form-control form-control-solid bg-white border" name="otherEmails" required>
                          <span class="text-danger"></span>
                      </div>
                    <div class="align-self-end d-flex flex-row-reverse justify-content-end">
                   <a class="btn btn-danger btn-sm" onclick="removeMail(this)"><span class="h5 text-light">X</span></a>
                    </div>
                    </div>
                    </div>`;

        //Append created otheremails
        $("#otherEmails").append(template);

    }
</script>

<script>
    function removeMail(prop) {
        $(prop).parent().parent().parent().remove();
    }
</script>